{
  "db": "PostgreSQL",
  "02b2bdbc58153f4eb1decf01b1fb912fe086e86b4ab5eae1e83182ca88ce0949": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "version",
          "ordinal": 1,
          "type_info": "Int4"
        },
        {
          "name": "account_id",
          "ordinal": 2,
          "type_info": "Uuid"
        },
        {
          "name": "onchain_incoming_ledger_account_id",
          "ordinal": 3,
          "type_info": "Uuid"
        },
        {
          "name": "onchain_at_rest_ledger_account_id",
          "ordinal": 4,
          "type_info": "Uuid"
        },
        {
          "name": "onchain_outgoing_ledger_account_id",
          "ordinal": 5,
          "type_info": "Uuid"
        },
        {
          "name": "onchain_fee_ledger_account_id",
          "ordinal": 6,
          "type_info": "Uuid"
        },
        {
          "name": "logical_incoming_ledger_account_id",
          "ordinal": 7,
          "type_info": "Uuid"
        },
        {
          "name": "logical_at_rest_ledger_account_id",
          "ordinal": 8,
          "type_info": "Uuid"
        },
        {
          "name": "logical_outgoing_ledger_account_id",
          "ordinal": 9,
          "type_info": "Uuid"
        },
        {
          "name": "dust_ledger_account_id",
          "ordinal": 10,
          "type_info": "Uuid"
        },
        {
          "name": "name",
          "ordinal": 11,
          "type_info": "Varchar"
        },
        {
          "name": "wallet_cfg",
          "ordinal": 12,
          "type_info": "Jsonb"
        },
        {
          "name": "created_at",
          "ordinal": 13,
          "type_info": "Timestamptz"
        },
        {
          "name": "modified_at",
          "ordinal": 14,
          "type_info": "Timestamptz"
        },
        {
          "name": "journal_id",
          "ordinal": 15,
          "type_info": "Uuid"
        },
        {
          "name": "keychain_id",
          "ordinal": 16,
          "type_info": "Uuid"
        },
        {
          "name": "keychain_cfg",
          "ordinal": 17,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Text"
        ]
      }
    },
    "query": "WITH latest AS (\n              SELECT w.*, a.journal_id \n              FROM bria_wallets w JOIN bria_accounts a ON w.account_id = a.id\n              WHERE a.id = $1 AND w.name = $2 ORDER BY version DESC LIMIT 1\n            )\n            SELECT l.*, k.id AS keychain_id, keychain_cfg\n                 FROM bria_wallet_keychains k\n                 JOIN latest l ON k.wallet_id = l.id\n                 ORDER BY sequence DESC"
  },
  "0e1beecb2d8045b25c5b4bdd4e2f8c1bc707c0cf379705adbce374cfdc78fc23": {
    "describe": {
      "columns": [
        {
          "name": "tx_id",
          "ordinal": 0,
          "type_info": "Varchar"
        },
        {
          "name": "utxo_json",
          "ordinal": 1,
          "type_info": "Jsonb"
        },
        {
          "name": "details_json",
          "ordinal": 2,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Int4"
        ]
      }
    },
    "query": "WITH updated_utxo AS (\n            UPDATE bdk_utxos SET confirmation_synced_to_bria = true, modified_at = NOW()\n            WHERE keychain_id = $1 AND (tx_id, vout) IN (\n                SELECT u.tx_id, vout\n                FROM bdk_utxos u\n                JOIN bdk_transactions t\n                ON u.keychain_id = t.keychain_id AND u.tx_id = t.tx_id\n                WHERE u.keychain_id = $1\n                AND utxo_json->>'keychain' = 'External'\n                AND u.synced_to_bria = true\n                AND u.confirmation_synced_to_bria = false\n                AND (details_json->'confirmation_time'->'height')::INTEGER <= $2\n                ORDER BY t.height ASC NULLS LAST\n                LIMIT 1\n            )\n            RETURNING tx_id, utxo_json\n            )\n            SELECT u.tx_id, utxo_json, details_json\n            FROM updated_utxo u JOIN bdk_transactions t on u.tx_id = t.tx_id"
  },
  "1071eb38b4d772554beb04d7bb3c3a563829d105b9657b67ba36c9d7b55d825e": {
    "describe": {
      "columns": [
        {
          "name": "batch_id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Text",
          "Int4"
        ]
      }
    },
    "query": "SELECT batch_id\n            FROM bria_batch_spent_utxos\n            WHERE keychain_id = $1 AND tx_id = $2 AND vout = $3"
  },
  "115999f874d3397311d1ebc501e47eef0a01993a7f573873b6d0a5d87cbb0866": {
    "describe": {
      "columns": [
        {
          "name": "index",
          "ordinal": 0,
          "type_info": "Int4"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          }
        ]
      }
    },
    "query": "SELECT index FROM bdk_indexes\n          WHERE keychain_id = $1 AND keychain_kind = $2 ORDER BY index DESC LIMIT 1"
  },
  "1e5a38689d22733b68e1e66320a8cdbdc5d6d692e44e72c735bafe657e7ddf1f": {
    "describe": {
      "columns": [
        {
          "name": "name",
          "ordinal": 0,
          "type_info": "Varchar"
        },
        {
          "name": "derivation_path",
          "ordinal": 1,
          "type_info": "Varchar"
        },
        {
          "name": "original",
          "ordinal": 2,
          "type_info": "Varchar"
        },
        {
          "name": "xpub",
          "ordinal": 3,
          "type_info": "Bytea"
        }
      ],
      "nullable": [
        false,
        true,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Bytea"
        ]
      }
    },
    "query": "SELECT name, derivation_path, original, xpub FROM bria_xpubs WHERE account_id = $1 AND xpub = $2"
  },
  "2386eba5a6696d646892d8282d27bc81d5ca1368f76c18528293bcc5005b8389": {
    "describe": {
      "columns": [
        {
          "name": "wallet_id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "keychain_id",
          "ordinal": 1,
          "type_info": "Uuid"
        },
        {
          "name": "tx_id",
          "ordinal": 2,
          "type_info": "Varchar"
        },
        {
          "name": "vout",
          "ordinal": 3,
          "type_info": "Int4"
        },
        {
          "name": "kind: pg::PgKeychainKind",
          "ordinal": 4,
          "type_info": {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "keychainkind"
            }
          }
        },
        {
          "name": "address_idx",
          "ordinal": 5,
          "type_info": "Int4"
        },
        {
          "name": "value",
          "ordinal": 6,
          "type_info": "Numeric"
        },
        {
          "name": "address",
          "ordinal": 7,
          "type_info": "Varchar"
        },
        {
          "name": "bdk_spent",
          "ordinal": 8,
          "type_info": "Bool"
        },
        {
          "name": "optional_address",
          "ordinal": 9,
          "type_info": "Varchar"
        },
        {
          "name": "block_height",
          "ordinal": 10,
          "type_info": "Int4"
        },
        {
          "name": "pending_income_ledger_tx_id",
          "ordinal": 11,
          "type_info": "Uuid"
        },
        {
          "name": "confirmed_income_ledger_tx_id",
          "ordinal": 12,
          "type_info": "Uuid"
        },
        {
          "name": "spending_batch_id",
          "ordinal": 13,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        null,
        true,
        false,
        true,
        true
      ],
      "parameters": {
        "Left": [
          "UuidArray"
        ]
      }
    },
    "query": "SELECT wallet_id, keychain_id, tx_id, vout, kind as \"kind: pg::PgKeychainKind\", address_idx, value, address, bdk_spent,\n                  CASE\n                      WHEN kind = 'external' THEN address\n                      ELSE NULL\n                  END as optional_address,\n                  block_height, pending_income_ledger_tx_id, confirmed_income_ledger_tx_id, spending_batch_id\n           FROM bria_utxos\n           WHERE keychain_id = ANY($1) AND bdk_spent = false\n           ORDER BY created_at DESC"
  },
  "277091eb889c9bfe2dac75ef4f634ff9a22328710da5608e39c79d2f212d1995": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Text",
          "Int4"
        ]
      }
    },
    "query": "UPDATE bdk_utxos SET synced_to_bria = true, modified_at = NOW()\n            WHERE keychain_id = $1 AND tx_id = $2 AND vout = $3"
  },
  "2d8175d62037c8d586f50aa366000c92f17090b4f88a0d8d971ad29d2188f3af": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Uuid",
          "Uuid"
        ]
      }
    },
    "query": "UPDATE bria_batch_wallet_summaries\n               SET create_batch_ledger_tx_id = $1\n               WHERE wallet_id = $2 AND batch_id = $3 AND create_batch_ledger_tx_id IS NULL"
  },
  "2efcb24d9b29b54e7d682f191f1dda750834dcfc6c76a1d7487e50c3f3bab9b6": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "batch_group_id",
          "ordinal": 1,
          "type_info": "Uuid"
        },
        {
          "name": "batch_id?",
          "ordinal": 2,
          "type_info": "Uuid"
        },
        {
          "name": "satoshis",
          "ordinal": 3,
          "type_info": "Int8"
        },
        {
          "name": "destination_data",
          "ordinal": 4,
          "type_info": "Jsonb"
        },
        {
          "name": "external_id",
          "ordinal": 5,
          "type_info": "Varchar"
        },
        {
          "name": "metadata",
          "ordinal": 6,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        false,
        true
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "WITH latest AS (\n             SELECT DISTINCT(id), MAX(version) OVER (PARTITION BY id ORDER BY version DESC)\n             FROM bria_payouts\n             WHERE wallet_id = $1\n           ) SELECT bria_payouts.id, batch_group_id, bria_batch_payouts.batch_id as \"batch_id?\", satoshis, destination_data, external_id, metadata FROM bria_payouts\n             LEFT JOIN bria_batch_payouts ON bria_payouts.id = bria_batch_payouts.payout_id\n             WHERE (bria_payouts.id, version) IN (SELECT * FROM latest)\n             ORDER BY created_at"
  },
  "2fa457a8cb724012819382713463f08be00258a86067984914abe8ebee3d38fa": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": []
      }
    },
    "query": "SELECT distinct(id) FROM bria_wallets"
  },
  "316920ab6db6dd6b3aa325b40c6908d1e166792781dde5289f0d26113bb76428": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "wallet_id",
          "ordinal": 1,
          "type_info": "Uuid"
        },
        {
          "name": "destination_data",
          "ordinal": 2,
          "type_info": "Jsonb"
        },
        {
          "name": "satoshis",
          "ordinal": 3,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "WITH latest AS (\n                 SELECT DISTINCT(id), MAX(version) OVER (PARTITION BY id ORDER BY version DESC)\n                 FROM bria_payouts LEFT JOIN bria_batch_payouts ON id = payout_id\n                 WHERE batch_group_id = $1 AND payout_id IS NULL\n               ) SELECT id, wallet_id, destination_data, satoshis FROM bria_payouts\n                 WHERE (id, version) IN (SELECT * FROM latest)\n                 ORDER BY priority, created_at"
  },
  "323bf243d28db3a7f6810a2e640a8339e41793a7982e9ed6dc7175570f1d921d": {
    "describe": {
      "columns": [
        {
          "name": "script_bytes",
          "ordinal": 0,
          "type_info": "Bytea"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          }
        ]
      }
    },
    "query": "SELECT script_bytes\n            FROM bdk_descriptor_checksums WHERE keychain_id = $1 AND keychain_kind = $2"
  },
  "34dec721ee5f61bc0dc86a71d6fab7d7c8417180ae7c16440ba24fb80804509f": {
    "describe": {
      "columns": [
        {
          "name": "keychain_kind: BdkKeychainKind",
          "ordinal": 0,
          "type_info": {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          }
        },
        {
          "name": "path",
          "ordinal": 1,
          "type_info": "Int4"
        }
      ],
      "nullable": [
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Bytea"
        ]
      }
    },
    "query": "SELECT keychain_kind as \"keychain_kind: BdkKeychainKind\", path FROM bdk_script_pubkeys\n            WHERE keychain_id = $1 AND script_hex = ENCODE($2, 'hex')"
  },
  "45ae4f218ab3a64c547f6b93d06003de96f1d2136f44e6936e450463ecde0fc1": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Text",
          "Int4"
        ]
      }
    },
    "query": "UPDATE bdk_utxos SET confirmation_synced_to_bria = true, modified_at = NOW()\n            WHERE keychain_id = $1 AND tx_id = $2 AND vout = $3"
  },
  "46b5eee37f84d1274f4d22a0ee26d4399fe629ea70f25d5974a4859fee6cd0fe": {
    "describe": {
      "columns": [
        {
          "name": "utxo_json",
          "ordinal": 0,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "SELECT utxo_json FROM bdk_utxos WHERE keychain_id = $1"
  },
  "4765468ce85318bb81f26d14951f01b674a39f34c13ab0c996bf132978680dcf": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Uuid",
          "Jsonb"
        ]
      }
    },
    "query": "INSERT INTO bria_wallet_keychains (account_id, wallet_id, keychain_cfg)\n            VALUES ($1, $2, $3)"
  },
  "4a39d07c30385438386e90c255154d7a9edc8f2cf6789044e2a08976b8a87629": {
    "describe": {
      "columns": [
        {
          "name": "name",
          "ordinal": 0,
          "type_info": "Varchar"
        },
        {
          "name": "derivation_path",
          "ordinal": 1,
          "type_info": "Varchar"
        },
        {
          "name": "original",
          "ordinal": 2,
          "type_info": "Varchar"
        },
        {
          "name": "xpub",
          "ordinal": 3,
          "type_info": "Bytea"
        }
      ],
      "nullable": [
        false,
        true,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Text"
        ]
      }
    },
    "query": "SELECT name, derivation_path, original, xpub FROM bria_xpubs WHERE account_id = $1 AND name = $2"
  },
  "615d249f09798303a86ba4f5499901958ac4409ff67a4273e4576a773f47c6f0": {
    "describe": {
      "columns": [
        {
          "name": "tx_id",
          "ordinal": 0,
          "type_info": "Varchar"
        },
        {
          "name": "details_json",
          "ordinal": 1,
          "type_info": "Jsonb"
        },
        {
          "name": "utxo_json",
          "ordinal": 2,
          "type_info": "Jsonb"
        },
        {
          "name": "path",
          "ordinal": 3,
          "type_info": "Int4"
        },
        {
          "name": "vout",
          "ordinal": 4,
          "type_info": "Int4"
        },
        {
          "name": "is_tx_output!",
          "ordinal": 5,
          "type_info": "Bool"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        null
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "TextArray"
        ]
      }
    },
    "query": "WITH tx_to_sync AS (\n           SELECT tx_id, details_json, height\n           FROM bdk_transactions\n           WHERE keychain_id = $1 AND synced_to_bria = false AND tx_id != ALL($2)\n           ORDER BY (details_json->'confirmation_time'->'height') ASC NULLS LAST\n           LIMIT 1\n           ),\n           previous_outputs AS (\n               SELECT (jsonb_array_elements(details_json->'transaction'->'input')->>'previous_output') AS output\n               FROM tx_to_sync\n           )\n           SELECT t.tx_id, details_json, utxo_json, path, vout,\n                  CASE WHEN u.tx_id = t.tx_id THEN true ELSE false END AS \"is_tx_output!\"\n           FROM bdk_utxos u\n           JOIN tx_to_sync t ON u.tx_id = t.tx_id OR CONCAT(u.tx_id, ':', u.vout::text) = ANY(\n               SELECT output FROM previous_outputs\n           ) OR u.tx_id = t.tx_id\n           JOIN bdk_script_pubkeys p\n           ON p.keychain_id = $1 AND u.utxo_json->'txout'->>'script_pubkey' = p.script_hex\n           WHERE u.keychain_id = $1 AND (u.synced_to_bria = false OR u.tx_id != t.tx_id)\n        "
  },
  "6be0e1f0b1e056688e4e276b13a40d5b6423b960df7dbff0b2a2f5e1bec3dc33": {
    "describe": {
      "columns": [
        {
          "name": "name",
          "ordinal": 0,
          "type_info": "Varchar"
        },
        {
          "name": "derivation_path",
          "ordinal": 1,
          "type_info": "Varchar"
        },
        {
          "name": "original",
          "ordinal": 2,
          "type_info": "Varchar"
        },
        {
          "name": "xpub",
          "ordinal": 3,
          "type_info": "Bytea"
        }
      ],
      "nullable": [
        false,
        true,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Bytea"
        ]
      }
    },
    "query": "SELECT name, derivation_path, original, xpub FROM bria_xpubs WHERE account_id = $1 AND fingerprint = $2"
  },
  "73a00973e7edde6b076ab47e4252ede62c22d65acce920110dc1497a5997025e": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Varchar",
          "Text",
          "Uuid"
        ]
      }
    },
    "query": "INSERT INTO bria_account_api_keys (name, encrypted_key, account_id)\n            VALUES ($1, crypt($2, gen_salt('bf')), (SELECT id FROM bria_accounts WHERE id = $3)) RETURNING (id)"
  },
  "73e658dc30bd137f4aa6b118aa8919ff6b9d5cfd9a63dd147d7cc2e2a71bd182": {
    "describe": {
      "columns": [
        {
          "name": "details_json",
          "ordinal": 0,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "\n        SELECT details_json FROM bdk_transactions WHERE keychain_id = $1"
  },
  "75621ca434e9c583f743225f582e376e719dbb4810462b9092ecfef5c676fdd3": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Varchar"
        ]
      }
    },
    "query": "INSERT INTO bria_accounts (id, name, journal_id)\n            VALUES ($1, $2, $1)\n            RETURNING (id)"
  },
  "79b2407aa9d9a2aa44448d5baf73bc0d35b216894a108858ffb4b0aecc22a4c7": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "version",
          "ordinal": 1,
          "type_info": "Int4"
        },
        {
          "name": "account_id",
          "ordinal": 2,
          "type_info": "Uuid"
        },
        {
          "name": "onchain_incoming_ledger_account_id",
          "ordinal": 3,
          "type_info": "Uuid"
        },
        {
          "name": "onchain_at_rest_ledger_account_id",
          "ordinal": 4,
          "type_info": "Uuid"
        },
        {
          "name": "onchain_outgoing_ledger_account_id",
          "ordinal": 5,
          "type_info": "Uuid"
        },
        {
          "name": "onchain_fee_ledger_account_id",
          "ordinal": 6,
          "type_info": "Uuid"
        },
        {
          "name": "logical_incoming_ledger_account_id",
          "ordinal": 7,
          "type_info": "Uuid"
        },
        {
          "name": "logical_at_rest_ledger_account_id",
          "ordinal": 8,
          "type_info": "Uuid"
        },
        {
          "name": "logical_outgoing_ledger_account_id",
          "ordinal": 9,
          "type_info": "Uuid"
        },
        {
          "name": "dust_ledger_account_id",
          "ordinal": 10,
          "type_info": "Uuid"
        },
        {
          "name": "name",
          "ordinal": 11,
          "type_info": "Varchar"
        },
        {
          "name": "wallet_cfg",
          "ordinal": 12,
          "type_info": "Jsonb"
        },
        {
          "name": "created_at",
          "ordinal": 13,
          "type_info": "Timestamptz"
        },
        {
          "name": "modified_at",
          "ordinal": 14,
          "type_info": "Timestamptz"
        },
        {
          "name": "journal_id",
          "ordinal": 15,
          "type_info": "Uuid"
        },
        {
          "name": "keychain_id",
          "ordinal": 16,
          "type_info": "Uuid"
        },
        {
          "name": "keychain_cfg",
          "ordinal": 17,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "UuidArray"
        ]
      }
    },
    "query": "WITH latest AS (\n              SELECT w.*, a.journal_id\n              FROM bria_wallets w JOIN bria_accounts a ON w.account_id = a.id\n              WHERE w.id = ANY($1) ORDER BY version DESC LIMIT 1\n            )\n            SELECT l.*, k.id AS keychain_id, keychain_cfg\n                 FROM bria_wallet_keychains k\n                 JOIN latest l ON k.wallet_id = l.id\n                 ORDER BY sequence DESC"
  },
  "79eff690e77e488dccc3c066b265e7718128987e44d97f408059cca30fc5124c": {
    "describe": {
      "columns": [
        {
          "name": "script",
          "ordinal": 0,
          "type_info": "Bytea"
        },
        {
          "name": "keychain_kind: BdkKeychainKind",
          "ordinal": 1,
          "type_info": {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          }
        }
      ],
      "nullable": [
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "SELECT script, keychain_kind as \"keychain_kind: BdkKeychainKind\" FROM bdk_script_pubkeys\n            WHERE keychain_id = $1"
  },
  "7b1d062ab3ccd35c471f9d59b4e475d4a42397782c3eaa9a35ac02ee30d85ac7": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Text"
        ]
      }
    },
    "query": "UPDATE bdk_transactions SET synced_to_bria = true, modified_at = NOW()\n            WHERE keychain_id = $1 AND tx_id = $2"
  },
  "7b607fb78d590c932a28997018de6b10432b399c9c42a1278179dffd8720cfbf": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Jsonb",
          "Uuid",
          "Uuid",
          "Uuid",
          "Uuid",
          "Uuid",
          "Uuid",
          "Uuid",
          "Uuid",
          "Uuid",
          "Varchar"
        ]
      }
    },
    "query": "INSERT INTO bria_wallets\n               (id, wallet_cfg, account_id,\n               onchain_incoming_ledger_account_id, onchain_at_rest_ledger_account_id, onchain_outgoing_ledger_account_id,\n               logical_incoming_ledger_account_id, logical_at_rest_ledger_account_id, logical_outgoing_ledger_account_id,\n               onchain_fee_ledger_account_id, dust_ledger_account_id, name)\n            VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)\n            RETURNING (id)"
  },
  "7d36b5cd24ecbc930a45b73876bf356abb1a773c37ebb161c3a2c14fe63f9a15": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Varchar",
          "Jsonb",
          "Int4",
          "Int4"
        ]
      }
    },
    "query": "\n        INSERT INTO bdk_transactions (keychain_id, tx_id, details_json, sent, height)\n        VALUES ($1, $2, $3, $4, $5) ON CONFLICT (keychain_id, tx_id)\n        DO UPDATE SET details_json = EXCLUDED.details_json, height = $5, modified_at = NOW()"
  },
  "7d7af417c1ef479000d3a7cfc4e481d4c1724e92df0a4a2a3d7e04387c80ab47": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "account_id",
          "ordinal": 1,
          "type_info": "Uuid"
        },
        {
          "name": "name",
          "ordinal": 2,
          "type_info": "Varchar"
        },
        {
          "name": "batch_cfg",
          "ordinal": 3,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "SELECT id, account_id, name, batch_cfg\n                 FROM bria_batch_groups\n                 WHERE id = $1 ORDER BY version DESC LIMIT 1"
  },
  "7ffd870c69bda78f7d81488e6f10e9e06be55fe817f433644fd07566148b20ff": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Uuid",
          "Text",
          "Jsonb"
        ]
      }
    },
    "query": "\n            INSERT INTO bria_xpub_signers (id, account_id, xpub_name, signer_cfg)\n            VALUES ($1, $2, (SELECT name FROM bria_xpubs WHERE account_id = $2 AND name = $3), $4)\n            "
  },
  "92405eb1906f643a2fee07533f746ad9fbb376713c8178aee4a31074949901fe": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Int4",
          "Int4"
        ]
      }
    },
    "query": "INSERT INTO bdk_sync_times (keychain_id, height, timestamp)\n            VALUES ($1, $2, $3)\n            ON CONFLICT (keychain_id) DO UPDATE SET height = EXCLUDED.height, timestamp = EXCLUDED.timestamp, modified_at = NOW()"
  },
  "97a5260a58ba4406e63c10b5789a5a262d2b11a4730c42d87bd26cee86de67d8": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Uuid",
          "Varchar",
          "Int4",
          "Float4",
          "Bool",
          {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "keychainkind"
            }
          },
          "Int4",
          "Numeric",
          "Varchar",
          "Varchar",
          "Uuid"
        ]
      }
    },
    "query": "INSERT INTO bria_utxos\n               (wallet_id, keychain_id, tx_id, vout, sats_per_vbyte_when_created, self_pay, kind, address_idx, value, address, script_hex, pending_income_ledger_tx_id)\n               VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)\n               ON CONFLICT (keychain_id, tx_id, vout) DO NOTHING"
  },
  "9e38db9fbc99cd77dd9df1ac60513d37e2c31bef5876113dff5842f3daa9c308": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Uuid",
          "Int8",
          "Bytea",
          "Bytea"
        ]
      }
    },
    "query": "INSERT INTO bria_batches (id, batch_group_id, total_fee_sats, bitcoin_tx_id, unsigned_psbt)\n            VALUES ($1, $2, $3, $4, $5)"
  },
  "a17c30ab0f4af264c0239ee4f9aee7dbc3d1c90901d0a21c6682131ba5a7742e": {
    "describe": {
      "columns": [
        {
          "name": "details_json",
          "ordinal": 0,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Text"
        ]
      }
    },
    "query": "\n        SELECT details_json FROM bdk_transactions WHERE keychain_id = $1 AND tx_id = $2"
  },
  "a74a4e9764b8eb817645da55cb067b01c71e8c13e4e251f00857a3b1b0d8b8e4": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Varchar",
          "Int4",
          "Jsonb",
          "Bool"
        ]
      }
    },
    "query": "INSERT INTO bdk_utxos (keychain_id, tx_id, vout, utxo_json, is_spent)\n            VALUES ($1, $2, $3, $4, $5) ON CONFLICT (keychain_id, tx_id, vout)\n            DO UPDATE SET utxo_json = EXCLUDED.utxo_json, is_spent = $5, modified_at = NOW()"
  },
  "a8eb9dddd47a58ae77b39f1e0a33a6c7007ff6a631c043dd03941efad2b313e1": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Varchar",
          "Varchar",
          "Bytea",
          "Varchar",
          "Bytea",
          "Bytea"
        ]
      }
    },
    "query": "INSERT INTO bria_xpubs\n            (account_id, name, original, xpub, derivation_path, fingerprint, parent_fingerprint)\n            VALUES ((SELECT id FROM bria_accounts WHERE id = $1), $2, $3, $4, $5, $6, $7)"
  },
  "ad78368dbc971b6a7b2862931c078c73eaf6b8859399a7f12cad771621eac290": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          },
          "Int4"
        ]
      }
    },
    "query": "INSERT INTO bdk_indexes (keychain_id, keychain_kind, index)\n                VALUES ($1, $2, $3) ON CONFLICT DO NOTHING"
  },
  "affee8ab9a8bc35b854fa93a674607dd86d27acb8ef8c9cd2dfb6a93394c26ae": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Uuid",
          "Uuid",
          "Uuid",
          "Int8",
          "Jsonb",
          "Varchar",
          "Jsonb"
        ]
      }
    },
    "query": "INSERT INTO bria_payouts (id, account_id, batch_group_id, wallet_id, satoshis, destination_data, external_id, metadata)\n               VALUES ($1, $2, $3, $4, $5, $6, $7, $8)"
  },
  "b4ff1533cd12d644b6959e11e7594e2d04a10913c7b49eae397ad41b3f918b5c": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Bytea",
          {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          },
          "Uuid"
        ]
      }
    },
    "query": "INSERT INTO bdk_descriptor_checksums (script_bytes, keychain_kind, keychain_id)\n            VALUES ($1, $2, $3)"
  },
  "bba0456ebcbee4145b3954bd2f6147b0734202900a5ed8496e6f720dcd16601d": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "account_id",
          "ordinal": 1,
          "type_info": "Uuid"
        },
        {
          "name": "name",
          "ordinal": 2,
          "type_info": "Varchar"
        }
      ],
      "nullable": [
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text"
        ]
      }
    },
    "query": "SELECT id, account_id, name FROM bria_account_api_keys WHERE encrypted_key = crypt($1, encrypted_key)"
  },
  "c94b87874398fc084e897c01063b112b8f075b2b97c6808edf007324c7199fb8": {
    "describe": {
      "columns": [
        {
          "name": "batch_group_id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "bitcoin_tx_id",
          "ordinal": 1,
          "type_info": "Bytea"
        },
        {
          "name": "batch_id",
          "ordinal": 2,
          "type_info": "Uuid"
        },
        {
          "name": "wallet_id",
          "ordinal": 3,
          "type_info": "Uuid"
        },
        {
          "name": "total_in_sats",
          "ordinal": 4,
          "type_info": "Int8"
        },
        {
          "name": "total_spent_sats",
          "ordinal": 5,
          "type_info": "Int8"
        },
        {
          "name": "change_sats",
          "ordinal": 6,
          "type_info": "Int8"
        },
        {
          "name": "change_address",
          "ordinal": 7,
          "type_info": "Varchar"
        },
        {
          "name": "change_vout",
          "ordinal": 8,
          "type_info": "Int4"
        },
        {
          "name": "change_keychain_id",
          "ordinal": 9,
          "type_info": "Uuid"
        },
        {
          "name": "fee_sats",
          "ordinal": 10,
          "type_info": "Int8"
        },
        {
          "name": "create_batch_ledger_tx_id",
          "ordinal": 11,
          "type_info": "Uuid"
        },
        {
          "name": "submitted_ledger_tx_id",
          "ordinal": 12,
          "type_info": "Uuid"
        },
        {
          "name": "tx_id",
          "ordinal": 13,
          "type_info": "Varchar"
        },
        {
          "name": "vout",
          "ordinal": 14,
          "type_info": "Int4"
        },
        {
          "name": "keychain_id",
          "ordinal": 15,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        false,
        true,
        false,
        false,
        true,
        true,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "SELECT batch_group_id, bitcoin_tx_id, u.batch_id, s.wallet_id, total_in_sats, total_spent_sats, change_sats, change_address, change_vout, change_keychain_id, fee_sats, create_batch_ledger_tx_id, submitted_ledger_tx_id, tx_id, vout, keychain_id\n            FROM bria_batch_spent_utxos u\n            LEFT JOIN bria_batch_wallet_summaries s ON u.batch_id = s.batch_id AND u.wallet_id = s.wallet_id\n            LEFT JOIN bria_batches b ON b.id = u.batch_id\n            WHERE u.batch_id = $1"
  },
  "cea08e173999feced38d8c3d7039b2d2ea3bf7a26f7df74d33da7b2c0b772117": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "account_id",
          "ordinal": 1,
          "type_info": "Uuid"
        },
        {
          "name": "name",
          "ordinal": 2,
          "type_info": "Varchar"
        },
        {
          "name": "batch_cfg",
          "ordinal": 3,
          "type_info": "Jsonb"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": []
      }
    },
    "query": "WITH latest AS (\n                 SELECT DISTINCT(id), MAX(version) OVER (PARTITION BY id ORDER BY version DESC)\n                 FROM bria_batch_groups\n               ) SELECT id, account_id, name, batch_cfg FROM bria_batch_groups\n                 WHERE (id, version) IN (SELECT * FROM latest)"
  },
  "d210e678bab9acd40b3773d7bdc33c6b8b71c6a742e53d0d4c407b1ae5bb2528": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "Uuid",
          "Varchar",
          "Varchar",
          "Jsonb"
        ]
      }
    },
    "query": "\n            INSERT INTO bria_batch_groups (id, account_id, name, description, batch_cfg)\n            VALUES ($1, $2, $3, $4, $5)\n            "
  },
  "d6e6c21ec2c30cf06458087fc805aa0274b75c51a8271efe50f3128605a1c44c": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Text"
        ]
      }
    },
    "query": "SELECT id\n                 FROM bria_batch_groups\n                 WHERE account_id = $1 AND name = $2 ORDER BY version DESC LIMIT 1"
  },
  "dadf92f232ace36b25eebac9361458d8427ac4d6dcecf58fb9cb69c16737a48a": {
    "describe": {
      "columns": [
        {
          "name": "address_idx",
          "ordinal": 0,
          "type_info": "Int4"
        },
        {
          "name": "value",
          "ordinal": 1,
          "type_info": "Numeric"
        },
        {
          "name": "address",
          "ordinal": 2,
          "type_info": "Varchar"
        },
        {
          "name": "pending_income_ledger_tx_id",
          "ordinal": 3,
          "type_info": "Uuid"
        },
        {
          "name": "spending_batch_id",
          "ordinal": 4,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        true
      ],
      "parameters": {
        "Left": [
          "Bool",
          "Int4",
          "Uuid",
          "Uuid",
          "Text",
          "Int4"
        ]
      }
    },
    "query": "UPDATE bria_utxos\n            SET bdk_spent = $1,\n                block_height = $2,\n                confirmed_income_ledger_tx_id = $3,\n                modified_at = NOW()\n            WHERE keychain_id = $4\n              AND tx_id = $5\n              AND vout = $6\n            RETURNING address_idx, value, address, pending_income_ledger_tx_id, spending_batch_id"
  },
  "e093cc590f538bfdc34657ed4041535f771e6ad41679f068cba67ecff29c6ea5": {
    "describe": {
      "columns": [
        {
          "name": "keychain_id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "income_address",
          "ordinal": 1,
          "type_info": "Bool"
        },
        {
          "name": "tx_id",
          "ordinal": 2,
          "type_info": "Varchar"
        },
        {
          "name": "vout",
          "ordinal": 3,
          "type_info": "Int4"
        },
        {
          "name": "spending_batch_id",
          "ordinal": 4,
          "type_info": "Uuid"
        },
        {
          "name": "confirmed_income_ledger_tx_id",
          "ordinal": 5,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false,
        null,
        false,
        false,
        true,
        true
      ],
      "parameters": {
        "Left": [
          "UuidArray"
        ]
      }
    },
    "query": "SELECT keychain_id,\n               CASE WHEN kind = 'external' THEN true ELSE false END as income_address,\n               tx_id, vout, spending_batch_id, confirmed_income_ledger_tx_id\n               FROM bria_utxos\n               WHERE keychain_id = ANY($1) AND bdk_spent = false\n               FOR UPDATE"
  },
  "e2362a826e4a08190faa2f6529c3f255e4b81cd65c741318a33fbb49ddc27e38": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          },
          "Int4"
        ]
      }
    },
    "query": "INSERT INTO bdk_indexes (keychain_id, keychain_kind, index)\n                VALUES ($1, $2, $3)"
  },
  "e31e3eb7bcecededcab9a4ffb65bc901ba008955620597daf9e952a091ad20c3": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Varchar",
          "Text"
        ]
      }
    },
    "query": "INSERT INTO bria_admin_api_keys (name, encrypted_key)\n            VALUES ($1, crypt($2, gen_salt('bf'))) RETURNING (id)"
  },
  "f3e40cb1852fdfd9f7c3fd89e27760574d526b4746ff7d90677b1938bc2278bc": {
    "describe": {
      "columns": [
        {
          "name": "id",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "name",
          "ordinal": 1,
          "type_info": "Varchar"
        }
      ],
      "nullable": [
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text"
        ]
      }
    },
    "query": "SELECT id, name FROM bria_admin_api_keys WHERE encrypted_key = crypt($1, encrypted_key)"
  },
  "f6273d55a9ef0ab5746064b4064346c2789b6db97251e49d99d82d5e49dfd174": {
    "describe": {
      "columns": [
        {
          "name": "height",
          "ordinal": 0,
          "type_info": "Int4"
        },
        {
          "name": "timestamp",
          "ordinal": 1,
          "type_info": "Int4"
        }
      ],
      "nullable": [
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "SELECT height, timestamp FROM bdk_sync_times WHERE keychain_id = $1"
  },
  "f786f29a9de1c9f15a64fc7d541156184e9353f286c111aa90e74e1b950da39f": {
    "describe": {
      "columns": [
        {
          "name": "script",
          "ordinal": 0,
          "type_info": "Bytea"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          },
          "Int4"
        ]
      }
    },
    "query": "SELECT script FROM bdk_script_pubkeys\n            WHERE keychain_id = $1 AND keychain_kind = $2 AND path = $3"
  },
  "f98408969915608cf7f432f25df49b78644ce36eabdfe2a23f1fc6c14763c774": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          {
            "Custom": {
              "kind": {
                "Enum": [
                  "external",
                  "internal"
                ]
              },
              "name": "bdkkeychainkind"
            }
          },
          "Int4",
          "Bytea",
          "Varchar"
        ]
      }
    },
    "query": "INSERT INTO bdk_script_pubkeys\n            (keychain_id, keychain_kind, path, script, script_hex, script_fmt)\n            VALUES ($1, $2, $3, $4, ENCODE($4, 'hex'), $5) ON CONFLICT DO NOTHING"
  }
}